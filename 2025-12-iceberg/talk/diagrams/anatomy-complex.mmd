graph TD
    C["â˜ï¸ Catalog (DB)"] --> M["ðŸ“‹ metadata.json"]
    
    subgraph History
        M -.-> ML1["ðŸ“‹ snap-v1.avro"]
        M -.-> ML2["ðŸ“‹ snap-v2.avro"]
    end
    
    M --> ML3["ðŸ“‹ snap-v3.avro"]

    %% Snapshot 1: Initial state
    ML1 --> MF1["ðŸ“‹ manifest-old.avro"]

    %% Snapshot 2: Added data-003
    ML2 --> MF1
    ML2 --> MF2["ðŸ“‹ manifest-new.avro"]

    %% Snapshot 3: Rewrote data-001 -> data-001-v2
    %% Reuses manifest-new (data-003 unchanged)
    %% Replaces manifest-old with manifest-rewritten
    ML3 --> MF2
    ML3 --> MF3["ðŸ“‹ manifest-rewritten.avro"]

    %% Data connections
    MF1 --> D1["ðŸ“¦ data-001.parquet"]
    MF1 --> D2["ðŸ“¦ data-002.parquet"]
    
    MF2 --> D3["ðŸ“¦ data-003.parquet"]
    
    MF3 --> D1V2["ðŸ“¦ data-001-v2.parquet"]
    MF3 --> D2

    style ML1 stroke-dasharray: 5 5
    style ML2 stroke-dasharray: 5 5
    style D1 stroke-dasharray: 5 5
